<!-- Loading State -->
<div *ngIf="isLoading" class="min-h-screen bg-black text-gray-400 p-10">
  Loading job details...
</div>

<div *ngIf="!isLoading && job as j" class="min-h-screen bg-black text-white py-12">
  <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 lg:grid-cols-3 gap-10">
    <div class="lg:col-span-2 space-y-10">

      <div>
        <button
          class="mb-6 text-gray-300 hover:text-orange-400 transition"
          routerLink="/jobs"
        >
          ‚Üê Back to Job Listings
        </button>

        <h1 class="text-4xl font-bold mb-2">{{ j.title }}</h1>
        <p class="text-lg text-gray-300 font-medium">{{ j.company }}</p>

        <div class="flex flex-wrap gap-3 mt-3 text-sm text-gray-400">
          <span class="px-3 py-1 rounded-lg bg-gray-800/60">{{ j.location }}</span>
          <span class="px-3 py-1 rounded-lg bg-gray-800/60">{{ j.type }}</span>
          <span class="px-3 py-1 rounded-lg bg-gray-800/60">
            Posted {{ j.createdAt | date:'mediumDate' }}
          </span>
        </div>
      </div>

      <div>
        <h2 class="text-xl font-semibold mb-3">Job Description</h2>
        <p class="text-gray-300 leading-relaxed whitespace-pre-line">{{ j.description }}</p>
      </div>

      <div>
        <h2 class="text-xl font-semibold mb-3">Required Skills</h2>

        <div
          *ngIf="j.skills && j.skills.length > 0; else noSkills"
          class="flex flex-wrap gap-2"
        >
          <span
            *ngFor="let skill of j.skills"
            class="px-3 py-1 rounded-lg bg-gray-800/70 text-sm text-gray-300"
          >
            {{ skill }}
          </span>
        </div>

        <ng-template #noSkills>
          <p class="text-gray-500 text-sm">No specific skills listed.</p>
        </ng-template>
      </div>

      <div class="p-6 bg-gray-900/40 border border-gray-800 rounded-xl">
        <h2 class="text-xl font-semibold mb-2">AI Match Insights</h2>

        <p *ngIf="j.aiExplanation; else noAi" class="text-gray-300 leading-relaxed">
          {{ j.aiExplanation }}
        </p>

        <ng-template #noAi>
          <p class="text-gray-500 text-sm">
            AI did not provide additional insights for this job.
          </p>
        </ng-template>
      </div>

    </div>

    <div class="lg:col-span-1">
      <div class="sticky top-24">
        <app-job-summary-card [job]="j"></app-job-summary-card>
      </div>
    </div>

  </div>
</div>

<div *ngIf="!isLoading && !job" class="min-h-screen bg-black text-red-400 p-10">
  Failed to load job details.
</div>
